# genetic_robocode
Applying genetic approach to simple programming game.

Проект робота <b>Falcevor</b> для простой игры Robocode, предназначенной для обучения программированию на языке Java, был реализован в рамках учебного курса "Системы Искусственного Интеллекта".

<b>Учебное заведение:</b> Кубанский Государственный Университет <br>
<b>Факультет</b> Компьютерных технологий и прикладной математики <br>
<b>Группа:</b> 45 (по состоянию на январь 2018) <br>
<b>Разработчик:</b> Лукинов Даниил Романович <br>
<b>Руководитель:</b> Синица Сергей Геннадьевич <br>

<h3> Описание </h3>
В качестве основного механизма было решено реализовать генетический алгоритм. Реализованный проект состоит из двух частей, написанных на языках Java и Python. Первая часть - непосредственно код робота. Вторая часть - приложение, реализующее эволюционные процессы.<br>
Эволюционным подходом генерируются 3 функции: угол поворота робота, угол поворота орудия, дальность движения.<br>
Искомые функции в роботе представляются в виде karva-дерева, хранятся в строчной записи в файле, кодируются числами от 0 до 51, каждое из которых соответствует оператору, простейшей функции, константе, некоторому значению, характеризующему текущее состояние боя. (Сопоставление кодируемых функций задано в файле genetic_functions.xlsx)

<h4> Описание алгоритма робота </h4>
0. Производится загрузка особи из файла, генерируется karva-дерево.<br>1. Робот сканирует все поле в поисках противника. <br> 2. Когда противник найден, радар фиксируется на нем. <br> 3. Производится сканирование и сохранение текущего состояния противника. <br> 4. Производится поворот корпуса робота на угол, полученный из первой функции хромосомы, представленной в дереве. <br> 5. Производится поворот орудия на угол, полученный из второй функции хромосомы, представленной в дереве. <br> 6. Производится выстрел с силой обратно-пропорциональной расстоянию до противника. <br> 7. Производится передвижение вперед на значение, полученное из третьей фукнции хромосомы, представленной в дереве. <br> 8. Если бой не закончен, шаг 3, закончен - шаг 9. <br> 9. Производится сохранение статистики завершенного боя в файл. <br>

<h4> Описание эволюционного алгоритма </h4>
Размер популяции - 101<br>
Размер хромомсомы - 201<br>
Размер "головы" хромосомы - 50<br>
Максимальная арность операторов - 4<br>
Вероятность использования кусочного скрещивания - 40%<br>
Вероятность смешения при поэлементном скрещивании - 50%<br>
Вероятность мутации - 4%<br>

Фитнес-функция для функции угла поворота орудия - отношение успешных попадений к общему числу выстрелов.<br>
Фитнес-функция для функций угла поворота корпуса и дистанции движения - отношение общего числа выстрелов противника к числу его попадений. При этом производится штраф в виде 5% за каждый удар о стену, либо о противника.<br>
Селекция производится по методу рулетки (чем больше значение фитнес-функции у особи, тем больше вероятность, что она будет участвовать в скрещивании).<br>

Алгоритм:<br>
0. Формируется исходная популяция. Гены хромосом заполняются случайными значениями.<br>
1. Формируется файл боя для запуска Robocode.<br>
2. Производится запись очередной особи в файл, подхватываемый роботом.<br>
3. Производится запуск боя.<br>
4. Производится вычисление фитнес-функций для данной особи, исходя из результатов боя.<br>
5. Если не последняя особь, то шаг 2, если последняя - шаг 6.<br>
6. Производится вычисление средних, максимальных и суммарных значений фитнес-функций из всех особей.<br>
7. Если средние значения больше 50 и максимальные более 85, то конец, иначе - шаг 8.<br>
8. Производится селекция методом рулетки, формируются пары для скрещивания.<br>
9. Производится скрещивание пар, исходя из вероятностей.<br>
10. Производится мутация с определенной вероятностью в тех хромосомах, которые не являются лучшими (максимальное значение фитнес-функции и 3% от нее)
11. Шаг 2.

<h3> Результат </h3>
Обучение производилось в течение 5 часов на роботе sample.Crazy. Результат имеет вид:<br>
<table>
<tr><th>Попульция</th> <th>Ср. ФФ движения</th> <th>Макс. ФФ движения</th> <th>Ср. ФФ орудия </th><th>Макс. ФФ орудия </th><tr>
<tr><td> 0 </td><td> 19.840 </td><td> 84.676 </td><td> 1.1110 </td><td> 8.906</td></tr>
<tr><td> 1 </td><td> 26.409 </td><td> 88.092 </td><td> 1.3790 </td><td> 10.824</td></tr>
<tr><td> 2 </td><td> 30.988 </td><td> 87.538 </td><td> 1.3565 </td><td> 18.239</td></tr>
<tr><td> 3 </td><td> 32.388 </td><td> 89.952 </td><td> 1.1013 </td><td> 5.754</td></tr>
<tr><td> 4 </td><td> 34.231 </td><td> 91.185 </td><td> 1.1075 </td><td> 2.643</td></tr>
<tr><td> 5 </td><td> 36.699 </td><td> 89.420 </td><td> 1.1452 </td><td> 8.467</td></tr>
<tr><td> 6 </td><td> 40.663 </td><td> 92.443 </td><td> 1.1601 </td><td> 5.662</td></tr>
<tr><td> 7 </td><td> 40.894 </td><td> 90.407 </td><td> 1.0335 </td><td> 4.826</td></tr>
<tr><td> 8 </td><td> 38.240 </td><td> 89.267 </td><td> 1.0239 </td><td> 3.800</td></tr>
<tr><td> 9 </td><td> 38.862 </td><td> 86.815 </td><td> 1.1075 </td><td> 10.093</td></tr>
<tr><td> 10 </td><td> 40.675 </td><td> 89.080 </td><td> 1.1144 </td><td> 7.122</td></tr>
<tr><td> 11 </td><td> 39.592 </td><td> 89.273 </td><td> 1.0189 </td><td> 2.253</td></tr>
<tr><td> 12 </td><td> 40.476 </td><td> 91.656 </td><td> 1.1006 </td><td> 2.932</td></tr>
<tr><td> 13 </td><td> 41.056 </td><td> 89.971 </td><td> 1.0422 </td><td> 9.682</td></tr>
<tr><td> 14 </td><td> 44.238 </td><td> 93.333 </td><td> 0.9931 </td><td> 3.793</td></tr>
<tr><td> 15 </td><td> 43.532 </td><td> 88.006 </td><td> 1.0795 </td><td> 3.487</td></tr>
<tr><td> 16 </td><td> 40.659 </td><td> 92.528 </td><td> 0.9973 </td><td> 4.180</td></tr>
</table>
<b>Вывод:</b> Фитнес-функция для оценки угла поворота корпуса и дальности движения была выбрана довольно корректно, так как виден прогресс как в среднем, так и в максимальном значении фитнес-функции. Аналогичное нельзя сказать о функции угла поворота. Такие различия в результатах каждой новой популяции обусловлены случайными попадениями в противника, которые не поддаются функциональному описанию. Для того, чтобы обучение данной функции происходило более корректно, необходимо задать иную фитнес-функцию для оценки угла поворота орудия, но это невозможно в рамках текущей задачи, так как данные вроде величины, характеризующей на сколько сильно танк промазал, получить невозможно.
